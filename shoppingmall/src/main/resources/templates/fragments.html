<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <body>
    <!-- Header fragment -->
    <th:block th:fragment="header">
      <header>
        <div class="header-inner">
          <div class="logo"><a th:href="@{/}">오또코디</a></div>

          <nav class="center-nav">
            <a href="#">전체글</a>
            <a href="#">커뮤니티</a>
            <a href="#">실사후기</a>
            <a href="#">데일리룩</a>
            <a href="#">플리마켓</a>
          </nav>

          <div class="nav-right">
            <input type="text" placeholder="검색" />

            <div class="flex justify-end">
              <!-- 로그인 안 한 상태: 안전한 표현식 -->
              <div th:if="${isLoggedIn == null or !isLoggedIn}">
                <button id="loginBtn" class="login-btn">로그인</button>
              </div>

              <!-- 로그인 한 상태 -->
              <div th:if="${isLoggedIn}">
                <a th:href="@{/mypage}" class="mypage-btn">마이페이지</a>

                <form
                  th:action="@{/logout}"
                  method="post"
                  style="display: inline"
                >
                  <button type="submit" class="logout-btn">로그아웃</button>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- 로그인 모달 (signinRequest는 ControllerAdvice로 전역 제공 권장) -->
        <div id="loginModal" class="modal">
          <div class="modal-content">
            <span class="close">&times;</span>
            <h2>로그인</h2>

            <div
              th:if="${errorMessage}"
              class="alert alert-danger"
              role="alert"
            >
              <span th:text="${errorMessage}"></span>
            </div>

            <form
              th:action="@{/signin}"
              th:object="${signinRequest}"
              method="post"
            >
              <input type="text" th:field="*{email}" placeholder="이메일" />
              <input
                type="password"
                th:field="*{password}"
                placeholder="비밀번호"
              />
              <div class="login-options">
                <label><input type="checkbox" /> 로그인 상태 유지</label>
                <a href="#">ID/PW 찾기</a>
              </div>

              <button class="login-submit" type="submit">로그인</button>
            </form>

            <p class="signup-text">
              아직 회원이 아니신가요? <a href="/signup">회원가입 하기</a>
            </p>
            <div class="divider">또는</div>
            <button class="social-login naver">N</button>
          </div>
        </div>
        <link rel="stylesheet" href="/css/header.css" />
      </header>
      <script src="/js/header-script.js"></script>
    </th:block>

    <!-- Footer fragment -->
    <th:block th:fragment="footer">
      <footer>© 2025 패션 커뮤니티 게시판</footer>
      <link rel="stylesheet" href="/css/footer.css" />
    </th:block>
  </body>
</html>
